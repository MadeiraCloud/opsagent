{
	"component" : {
		"init" : {
			"state" : [
				{
					"stateid" 	: "1",
					"module" 	:  "package.yum.package",
					"parameter" : {
						"name" 			: {"git" : ""},
						"verify_gpg"	: false
					}
				},

				{
					"stateid"	: "2",
					"module" 	: "scm.git",
					"parameter" : {
						"repo"		:	"ssh - ssh://root@211.98.26.6/opt/source/madeira.git",
						"branch"	:	"master",
						"version"	:	"",
						"ssh_key"	:	"",
						"path"		:	"/madeira",
						"user"		:	"root",
						"group"		:	"root"
					}
				},

				{
					"stateid"	: "3",
					"module"	: "sys.user",
					"parameter"	:	{
						"username"	:	"InstantForge",
						"password"	:	"",
						"fullname"	:	"InstantForge",
						"shell"		:	"/sbin/nologin",
						"home"		:	"/madeira",
						"nologin"	:	"True",
						"groups"	:	[ "root" ]
					}
				}
			]
		},

		"redis" : {
			"state" : [
				{
					"stateid"	: "1",
					"module" 	: "scm.git",
					"parameter" : {
						"repo" 		: "git - git@github.com:antirez/redis.git",
						"branch" 	: "master",
						"path"		: "/madeira/deps/redis",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "2",
					"module" 	: "sys.cmd",
					"parameter" : {
						"bin"		:	"/bin/bash",
						"cmd"		:	"make; make install; make test",
						"cwd"		:	"/madeira/deps/redis",
						"user"		:	"root",
						"group"		:	"root"
					}
				},

				{
					"stateid"	: "3",
					"module" 	: "sys.cmd",
					"parameter" : {
						"bin" 		:	"/bin/bash",
						"cmd"		:	"sed -i -e '/^export LD_LIBRARY_PATH=/d'  ~/.bashrc; sed -i -e '/^export PYTHONPATH=/d'  ~/.bashrc; sed -i -e '/^export INSTANT_HOME=/d'  ~/.bashrc; echo >>  ~/.bashrc; echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/' >>  ~/.bashrc; echo 'export PYTHONPATH=/madeira/source/api/Source/' >> ~/.bashrc; echo 'export INSTANT_HOME=${MADEIRA}' >> ~/.bashrc; source ~/.bashrc;",
						"cwd"		:	"/madeira/deps/redis",
						"user"		:	"root",
						"group"		:	"root"
					}
				},
				{
					"stateid"	: "4",
					"module"	: "path.dir",
					"parameter"	:	{
						"path"		:	"/madeira/db/journal",
						"user"		:	"root",
						"group"		:	"root",
						"mode"		:	"0755",
						"recursive"	:	"True"
					}
				},
				{
					"stateid"	: "5",
					"module" 	: "sys.cmd",
					"parameter" : {
						"bin"	:	"/bin/bash",
						"cmd"	:	"chown InstantForge -R /madeira",
						"user"	:	"root",
						"group"	:	"root",
						"onlyif":	"[ `cat /etc/passwd | grep ^InstantForge | wc -l` -eq 1 ]"
					}
				}
			]
		},

		"boost" : {
			"state" : [
				{
					"stateid"	: "1",
					"module"	: "package.yum.package",
					"parameter" : {
						"name" : {
							"gcc" 				: "",
							"gcc-c++"			: "",
							"zlib-devel"		: "",
							"bzip2-devel"		: "",
							"libstdc++"			: "",
							"libstdc++-devel"	: "",
							"libicu"			: ""
						},
						"verify_gpg"	: false
					}
				},

				{
					"stateid"	: "2",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		:	"/bin/bash",
						"cmd"		:	"rpm -i *.el6.x86_64.rpm",
						"cwd"		:	"/madeira/util/boostrpm/rpm",
						"user"		:	"root",
						"group"		:	"root"
					}
				}
			]
		},

		"thrift" : {
			"state" : [
				{
					"stateid"	: "1",
					"module"	: "package.yum.package",
					"parameter" : {
						"name" : {
							"automake"			: "",
							"libtool"			: "",
							"flex"				: "",
							"bison"				: "",
							"pkgconfig"			: "",
							"gcc-c++"			: "",
							"boost-devel"		: "",
							"libevent-devel"	: "",
							"zlib-devel"		: "",
							"python-devel"		: "",
							"ruby-devel"		: ""
						}
					}
				},

				{
					"stateid"	: "2",
					"module"	: "scm.git",
					"parameter"	: {
						"repo"		: "git - https://git-wip-us.apache.org/repos/asf/thrift.git",
						"branch"	: "master",
						"path"		: "/madeira/deps/thrift",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "3",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		: "/bin/bash",
						"cmd"		: "./configure; make; make install;",
						"cwd"		: "/madeira/deps/thrift",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "4",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		: "/bin/bash",
						"cmd"		: "python setup.py install",
						"cwd"		: "/madeira/deps/thrift/lib/py",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "5",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		: "/bin/bash",
						"cmd"		: "./bootstrap.sh; make; make install;",
						"cwd"		: "/madeira/deps/thrift/contrib/fb303",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "6",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		: "/bin/bash",
						"cmd"		: "python setup.py install",
						"cwd"		: "/madeira/deps/thrift/contrib/fb303/py",
						"user"		: "root",
						"group"		: "root"
					}
				}
			]
		},

		"scribe" : {
			"state" : [
				{
					"stateid"	: "1",
					"module"	: "scm.git",
					"parameter"	: {
						"repo"		: "git - git://github.com/facebook/scribe.git",
						"branch"	: "master",
						"path"		: "/madeira/deps/scribe",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "2",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		: "/bin/bash",
						"cmd"		: "./bootstrap.sh --with-boost-filesystem=boost_filesystem; make; make install;",
						"cwd"		: "/madeira/deps/scribe",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "3",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin"		: "/bin/bash",
						"cmd"		: "python setup.py install",
						"cwd"		: "/madeira/deps/scribe/py",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "3",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin" 		:	"/bin/bash",
						"cmd"		:	"sed -i -e '/^export LD_LIBRARY_PATH=/d'  ~/.bashrc; sed -i -e '/^export PYTHONPATH=/d'  ~/.bashrc; sed -i -e '/^export INSTANT_HOME=/d'  ~/.bashrc; echo >>  ~/.bashrc; echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/' >>  ~/.bashrc; echo 'export PYTHONPATH=/madeira/source/api/Source/' >> ~/.bashrc; echo 'export INSTANT_HOME=${MADEIRA}' >> ~/.bashrc; source ~/.bashrc;",
						"cwd"		:	"/madeira/deps/redis",
						"user"		:	"root",
						"group"		:	"root"
					}
				},

				{
					"stateid"	: "4",
					"module" 	: "sys.cmd",
					"parameter" : {
						"bin"	:	"/bin/bash",
						"cmd"	:	"chown InstantForge -R /madeira",
						"user"	:	"root",
						"group"	:	"root",
						"onlyif":	"[ `cat /etc/passwd | grep ^InstantForge | wc -l` -eq 1 ]"
					}
				}
			]
		},

		"karajan" : {
			"state" : [
				{
					"stateid"	: "1",
					"module"	: "scm.git",
					"parameter"	: {
						"repo"		: "ssh - ssh://root@211.98.26.6/opt/source/api.git",
						"branch"	: "master",
						"path"		: "/madeira/source/api",
						"user"		: "root",
						"group"		: "root"
					}
				},

				{
					"stateid"	: "2",
					"module"	: "package.yum.package",
					"parameter"	: {
						"name" : {
							"python-devel"		: "",
							"python-setuptools"	: ""
						}
					}
				},

				{
					"stateid"	: "3",
					"module"	: "package.pip.package",
					"parameter"	: {
						"name" : {
							"gearman"	: "",
							"pymongo"	: ""
						}
					}
				},

				{
					"stateid"	: "4",
					"module"	: "sys.cmd",
					"parameter"	: {
						"bin" 		:	"/bin/bash",
						"cmd"		:	"sed -i -e '/^export LD_LIBRARY_PATH=/d'  ~/.bashrc; sed -i -e '/^export PYTHONPATH=/d'  ~/.bashrc; sed -i -e '/^export INSTANT_HOME=/d'  ~/.bashrc; echo >>  ~/.bashrc; echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/' >>  ~/.bashrc; echo 'export PYTHONPATH=/madeira/source/api/Source/' >> ~/.bashrc; echo 'export INSTANT_HOME=${MADEIRA}' >> ~/.bashrc; source ~/.bashrc;",
						"cwd"		:	"/madeira/source",
						"user"		:	"root",
						"group"		:	"root"
					}
				}
			]
		},

		"mongodb" : {
			"state" : [
				{
					"stateid"	: "1",
					"module"	: "package.yum.repo",
					"parameter"	: {
						"name"		: "10gen",
						"content"	: "[10gen]\nname=10gen Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64\ngpgcheck=0\nenabled=1"
					}
				},

				{
					"stateid"	: "2",
					"module"	: "package.yum.package",
					"parameter"	: {
						"name"		: {
							"mongo-10gen"			: "",
							"mongo-10gen-server"	: ""
						}
					}
				}
			]
		},

		////////////////////////////////////////////////////////////
		"test" : {
			"state" : [
				{
					"stateid" 	: "1",
					"module" 	:  "package.gem.package",
					"parameter" : {
						"name"	:	{
							"zool"	: ""
						}
					}
				},

				{
					"stateid" 	: "2",
					"module" 	:  "package.gem.source",
					"parameter" : {
						"url"	: "http://ruby.taobao.org/"
					}
				}
			]
		}
	}
}